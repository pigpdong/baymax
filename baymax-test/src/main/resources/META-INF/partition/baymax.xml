<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="
	   http://www.springframework.org/schema/beans 
	   http://www.springframework.org/schema/beans/spring-beans-3.2.xsd" >
	
	<bean id="baymaxRouteService" class="com.tongbanjie.baymax.support.BaymaxContext" init-method="init">
		<property name="tables">
			<list>
				<ref local="table_trade_order"/>
			</list>
		</property>
	</bean>
<!--
	<bean id="trade_order_simple" class="com.tongbanjie.baymax.router.strategy.ELPartitionTable">
		<property name="logicTableName" 	value="t_order"/>
		<property name="shardingKeys"		value="user_id"/>
		<property name="patten" 			value="t_order_{0}"/>
		<property name="disableFullScan" 	value="true"/>
		<property name="rules">
			<list>
				<value>user_id % 4</value>
			</list>
		</property>
		<property name="tableMapping">
			<list>
				<value>p1:0</value>
				<value>p1:1</value>
				<value>p2:2</value>
				<value>p2:3</value>
			</list>
		</property>
	</bean>-->

    <bean id="table_trade_order" class="com.tongbanjie.baymax.router.strategy.PartitionTable">
        <property name="logicTableName"             value="t_order"/>
        <property name="namePatten"                 value="t_order_{0}"/>
        <property name="rules">
            <list>
                <bean class="com.tongbanjie.baymax.router.strategy.rule.ELRule">
                    <property name="column"         value="user_id"/>
                    <property name="expression"     value="user_id % 4"/>
                    <property name="columnProcess">
                        <bean class="com.tongbanjie.baymax.support.SubRightColumnProcess">
                            <property name="length" value="2"/>
                        </bean>
                    </property>
                </bean>
            </list>
        </property>
        <property name="nodeMapping">
            <list>
                <value>p1:0</value>
                <value>p1:1</value>
                <value>p2:2</value>
                <value>p2:3</value>
            </list>
        </property>
    </bean>
	
	<!-- <bean id="trade_order_virtual" class="com.tongbanjie.baymax.partition.impl.VirtualTable">
		<property name="logicTableName" 	value="trade_order_t1"/>
		<property name="partitionColumns"		value="user_id,id"/>
		<property name="patten" 			value="trade_order_{00}"/>
		<property name="disableFullScan" 	value="true"/>
		<property name="rules">
			<list>
				<value>subInt.apply(id, 2) % 4 + 1</value>
				<value>subInt.apply(user_id, 2) % 4 + 1</value>
			</list>
		</property>
		<property name="tableMapping">
			<list>
				<value>p1:02</value>
				<value>p1:04</value>
				<value>p2:06</value>
				<value>p2:08</value>
			</list>
		</property>
	</bean>
	
	<bean id="trade_order_monthly" class="com.tongbanjie.baymax.partition.impl.MonthlyTable">
		<property name="logicTableName" 	value="trade_order_t2"/>
		<property name="partitionColumns"		value="user_id,id"/>
		<property name="patten" 			value="trade_order_{000000}"/>
		<property name="disableFullScan" 	value="true"/>
		<property name="tableLike"			value="trade_order_01"/>
		<property name="rules">
			<list>
				<value>subInt.apply(id, 2) % 4 + 1</value>
				<value>subInt.apply(user_id, 2) % 4 + 1</value>
			</list>
		</property>
		<property name="tableMapping">
			<list>
				<value>p1:201402-201502</value>
				<value>p2:201503-000000</value>
			</list>
		</property>
	</bean> -->
</beans>
